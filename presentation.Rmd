---
title: "Models for Non-Monotone Missing at Random Data"
author: "David Luke Thiessen"
date: "October 15, 2018"
output: 
  beamer_presentation:
   includes:
      in_header: headerpagenumbers.tex
bibliography: bibliography.bibtex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


## Outline
- Introduction 
- Background on Missing Data Theory
- Techniques for Correcting Bias / Variance
- Inverse Probability Weighting
- Methods for Modelling Missing Data Probabilities

## Introduction
In the basic statistical structure, there is a "population" consisting of a collection of individuals. We are interested in studying some aspect of the population (commonly a single characteristic or a relation between several characteristics), but for reasons of cost/time/convenience, are unable to take an observation from every individual.

Our approach is to randomly select a portion of the population, record observations from these individuals, then make generalizations to the rest of the population.


## Introduction: Example
A healthcare worker at a retirement home with 100 residents wants to know if the residents have high blood pressure. If they do, the retirement home should consider changing the menu to help improve their health. She randomly selects 30 residents to record their blood pressure.

The estimate of average blood pressure is:

\begin{equation}
\bar{x} = \frac{1}{n}\sum_{i=1}^{30} x_i
\end{equation}

and (under typical assumptions) the confidence interval would be:

\begin{equation}
(\bar{x} - z_{\alpha/2}\frac{s}{\sqrt{n}}, \, \bar{x} + z_{\alpha/2}\frac{s}{\sqrt{n}})
\end{equation}


## Introduction: The Problem
Some of the retirees refuse, and won't let the healthcare worker measure their blood pressure.

How should the worker calculate the estimate and confidence interval?

Remark: Missingness is a nuisance, not the objective of scientific study.

Question: Can auxillary information be used to recover (or estimate) the missing information?


## Introduction: A Naive Approach
Suppose that the healthcare worker decides to just ignore the residents who refuse to have their blood pressure recorded. She considers them as if they were not selected to be in the sample and estimates the average as:

\begin{equation}
\bar{x} = \frac{1}{|J|}\sum_{i \in J} x_i
\end{equation}

Where J is the set of residents in the sample who let their blood pressure be recorded.

Will this approach give an accurate estimate?

Answer: It depends, but in general this estimate is biased.


## Background: Notation
As in @SunBaoluo2017OIPW, we let $X = (X_1, X_2, ..., X_K)$ be a random vector representing the complete (fully observed) data.

Let $R$ be an integer between $1$ and $2^K$ denoting which of the variables $X_i$ are observed, with $R = 1$ indicating that all variables observed and $R = r > 1$ denoting that only the variables $X_{(r)} \subset X$ are observed (which could be the empty set).

Each individual is an independent and identically distributed observation from the random variable $(R_i, X_{(R)i})$. 


## Background: Missing Data Patterns
If the variables $X_i$ can be arranged such that $L_{(r+1)} \subset L_{(r)}$, then the data are said to have a monotone missing pattern. This is common in lifetime studies.

```{r}
X = c(6,4,4,3,2)
barplot(X,axes=FALSE,main="Monotone Missing",names.arg=c("X1","X2","X3","X4","X5"),density=c(rep(20,5)))
```


## Background: Missing Data Patterns
If the variables are not monotone missing, then they are non-monontone missing.

```{r}
X = c(6,4,4,3,2)
barplot(X,axes=FALSE,main="Non-monotone Missing",names.arg=c("X1","X2","X3","X4","X5"),density=c(rep(20,5)))
rect(xleft = 2.6, ybottom = 5, xright = 3.6, ytop = 6, density = 20,lwd=0.6)
rect(xleft = 5, ybottom = 3, xright = 6, ytop = 5, density = 20,lwd=0.6)
```

## Background: Missing Data Mechanisms
Missing Completely at Random (MCAR)

- Missingness is independent of the data.
- Example: The device the healthcare worker is using to record blood pressure is faulty, and the device randomly fails.

Missing at Random (MAR)

- Missingness can depend on data values that are observed, but not those that are unobserved.
- Example: The residents are more likely to refuse the healthcare worker the older they are (and the worker has a list of the ages of residents).

Missing Not at Random (MNAR)

- Neither of the two above conditions hold.
- Example: Residents with high blood pressure are more likely to refuse to have their blood pressure recorded.


## Background: Missing Data Mechanisms
Missing Completely at Random (MCAR)

\begin{equation}
P(R = r|l,\gamma) = P(R=r|\gamma)
\end{equation}

Missing at Random (MAR)

\begin{equation}
P(R=r|l,\gamma) = P(R=r|l^{\text{obs}},\gamma)
\end{equation}

Missing Not at Random (MNAR)

- Neither of the two above conditions hold.

Remark: We also need to make the assumption that:

\begin{equation}
P(R = r|l,\gamma) > \sigma > 0
\end{equation}

for some constant $\sigma$ and all possible $l$.

## Background: Examples of Missing Data Mechanisms
Suppose that the data in question is $(X_1,X_2) \sim \text{N}(\mu,\Sigma)$, and the research objective is to study 

This slide will have the setting used for simulation/illustration of the following approaches.

Probably just details about the previous examples, something like Normally distributed, but missing values depending on ......


## Approaches for Analyzing with Missing Data
TODO: 

- Complete Case Analysis (CC)
    - Throw out the individuals with missing data, and do an analysis as if you had only measured n' individuals instead of the originally planned n.
- Inverse Probability Weighting (IPW)
    - Weight the different individuals differently in the analysis, making ones with rare observations carry more weight
- Single Imputation (SI)
    - Replace the missing values with other appropriately selected values.
    - Sometimes the average is used. In many situations this is wrong.
- Multiple Imputation (MI)
    - Replace missing values with randomly (but appropriately) selected values, but repeat this many times and then combine the conclusions together in a principled way.
    
- Likelihood Methods?


## Demonstration
TODO: Everything after here

- Show that CC analysis is unbiased for MCAR
- IPW and MI can correct for MAR, but not for MRAR
- Even if MNAR, it's better to treat as MAR then MCAR.
- Non identifiability of MNAR
- Discuss efficiency


## Inverse Probability Weighting
- Efficiency
- Easier to specify than full likelihood
- Less compuation demanding?


## Modelling Missing Data Probability
- Logistic
- Multinomial with only a few missing patterns and lots of data
- UMLE and CBE from Paper


## Another slide I made

A sample Latex Equation

\begin{equation}
X = \sum_{i = 1}^{5} y_i
\end{equation}

## Reference Example

More sample text [see @Nobody06].

The name of the reference is case sensitive. 

## References

